  -  name: Install nginx
     ansible.builtin.dnf:
       name: nginx
       state: present

  -  name: Copy nginx config file
     ansible.builtin.template:
       src: nginx.conf
       dest: /etc/nginx/nginx.conf

  -  name: Copy Expense config
     ansible.builtin.template:
       src: expense.conf
       dest: /etc/nginx/default.d/expense.conf


  -  name: Import App pre-requisties
     ansible.builtin.import_role:
       name: common
       tasks_from: app-pre-req

  -   name: Validate nginx configuration
      ansible.builtin.command: nginx -t
      register: nginx_test
      changed_when: false
      failed_when: false

  -  name: Print nginx config error
     ansible.builtin.debug:
       msg: "{{ nginx_test.stderr }}"
     when: nginx_test.rc != 0

  -  name: Enable and restart Nginx service
     ansible.builtin.systemd_service:
       name: nginx
       enabled: true
       state: restarted

#  -  name: Enable and restart Nginx service
#     ansible.builtin.systemd_service:
#       state: started
#       name: nginx
#       enabled: yes